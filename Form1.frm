VERSION 5.00
Begin VB.Form Form1 
   Caption         =   "Tester"
   ClientHeight    =   5715
   ClientLeft      =   2025
   ClientTop       =   1545
   ClientWidth     =   6585
   LinkTopic       =   "Form1"
   ScaleHeight     =   5715
   ScaleWidth      =   6585
   Begin ReportControl.ucReport ucReport1 
      Left            =   3900
      Top             =   240
      _ExtentX        =   661
      _ExtentY        =   609
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   0
      Left            =   0
      TabIndex        =   53
      Text            =   "Babena"
      Top             =   420
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   0
      Left            =   1200
      TabIndex        =   52
      Text            =   "Supplier"
      Top             =   420
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   0
      Left            =   2430
      TabIndex        =   51
      Text            =   "1"
      Top             =   420
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   1
      Left            =   0
      TabIndex        =   50
      Text            =   "Babena"
      Top             =   720
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   1
      Left            =   1200
      TabIndex        =   49
      Text            =   "Supplier"
      Top             =   720
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   1
      Left            =   2430
      TabIndex        =   48
      Text            =   "1"
      Top             =   720
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   2
      Left            =   0
      TabIndex        =   47
      Text            =   "Babena"
      Top             =   1020
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   2
      Left            =   1200
      TabIndex        =   46
      Text            =   "Supplier"
      Top             =   1020
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   2
      Left            =   2430
      TabIndex        =   45
      Text            =   "1"
      Top             =   1020
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   3
      Left            =   0
      TabIndex        =   44
      Text            =   "Babena"
      Top             =   1320
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   3
      Left            =   1200
      TabIndex        =   43
      Text            =   "Customer"
      Top             =   1320
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   3
      Left            =   2430
      TabIndex        =   42
      Text            =   "1"
      Top             =   1320
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   4
      Left            =   0
      TabIndex        =   41
      Text            =   "Babena IT"
      Top             =   1620
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   4
      Left            =   1200
      TabIndex        =   40
      Text            =   "Supplier"
      Top             =   1620
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   4
      Left            =   2430
      TabIndex        =   39
      Text            =   "1"
      Top             =   1620
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   5
      Left            =   0
      TabIndex        =   38
      Text            =   "Babena IT"
      Top             =   1920
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   5
      Left            =   1200
      TabIndex        =   37
      Text            =   "Supplier"
      Top             =   1920
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   5
      Left            =   2430
      TabIndex        =   36
      Text            =   "1"
      Top             =   1920
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   6
      Left            =   0
      TabIndex        =   35
      Text            =   "Babena IT"
      Top             =   2220
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   6
      Left            =   1200
      TabIndex        =   34
      Text            =   "Customer"
      Top             =   2220
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   6
      Left            =   2430
      TabIndex        =   33
      Text            =   "1"
      Top             =   2220
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   7
      Left            =   0
      TabIndex        =   32
      Text            =   "Babena IT"
      Top             =   2520
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   7
      Left            =   1200
      TabIndex        =   31
      Text            =   "Customer"
      Top             =   2520
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   7
      Left            =   2430
      TabIndex        =   30
      Text            =   "1"
      Top             =   2520
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   8
      Left            =   0
      TabIndex        =   29
      Text            =   "Babena IT"
      Top             =   2820
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   8
      Left            =   1200
      TabIndex        =   28
      Text            =   "Staff"
      Top             =   2820
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   8
      Left            =   2430
      TabIndex        =   27
      Text            =   "1"
      Top             =   2820
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   9
      Left            =   0
      TabIndex        =   26
      Text            =   "Babena IT"
      Top             =   3150
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   9
      Left            =   1200
      TabIndex        =   25
      Text            =   "Staff"
      Top             =   3150
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   9
      Left            =   2430
      TabIndex        =   24
      Text            =   "1"
      Top             =   3150
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   10
      Left            =   0
      TabIndex        =   23
      Text            =   "Babena MIX"
      Top             =   3450
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   10
      Left            =   1200
      TabIndex        =   22
      Text            =   "Supplier"
      Top             =   3450
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   10
      Left            =   2430
      TabIndex        =   21
      Text            =   "1"
      Top             =   3450
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   11
      Left            =   0
      TabIndex        =   20
      Text            =   "Babena MIX"
      Top             =   3750
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   11
      Left            =   1200
      TabIndex        =   19
      Text            =   "Supplier"
      Top             =   3750
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   11
      Left            =   2430
      TabIndex        =   18
      Text            =   "1"
      Top             =   3750
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   12
      Left            =   0
      TabIndex        =   17
      Text            =   "Babena MIX"
      Top             =   4050
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   12
      Left            =   1200
      TabIndex        =   16
      Text            =   "Customer"
      Top             =   4050
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   12
      Left            =   2430
      TabIndex        =   15
      Text            =   "1"
      Top             =   4050
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   13
      Left            =   0
      TabIndex        =   14
      Text            =   "Babena MIX"
      Top             =   4350
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   13
      Left            =   1200
      TabIndex        =   13
      Text            =   "Customer"
      Top             =   4350
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   13
      Left            =   2430
      TabIndex        =   12
      Text            =   "1"
      Top             =   4350
      Width           =   975
   End
   Begin VB.TextBox Text1 
      Height          =   285
      Index           =   14
      Left            =   0
      TabIndex        =   11
      Text            =   "Babena MIX"
      Top             =   4650
      Width           =   975
   End
   Begin VB.TextBox Text2 
      Height          =   285
      Index           =   14
      Left            =   1200
      TabIndex        =   10
      Text            =   "Customer"
      Top             =   4650
      Width           =   975
   End
   Begin VB.TextBox Text3 
      Height          =   285
      Index           =   14
      Left            =   2430
      TabIndex        =   9
      Text            =   "1"
      Top             =   4650
      Width           =   975
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Start Report"
      Height          =   495
      Index           =   0
      Left            =   3540
      TabIndex        =   8
      Top             =   1860
      Width           =   1305
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Preview Report"
      Height          =   495
      Index           =   1
      Left            =   3540
      TabIndex        =   7
      Top             =   2400
      Width           =   1305
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Print Report"
      Height          =   495
      Index           =   2
      Left            =   3540
      TabIndex        =   6
      Top             =   2940
      Width           =   1305
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Cancel Report"
      Height          =   495
      Index           =   3
      Left            =   3540
      TabIndex        =   5
      Top             =   3480
      Width           =   1305
   End
   Begin VB.CommandButton Command1 
      Caption         =   "Cancel Printing"
      Height          =   495
      Index           =   4
      Left            =   3540
      TabIndex        =   4
      Top             =   4020
      Width           =   1305
   End
   Begin VB.CheckBox Check2 
      Caption         =   "Group By"
      Height          =   405
      Index           =   2
      Left            =   2430
      TabIndex        =   3
      Top             =   0
      Width           =   1095
   End
   Begin VB.CheckBox Check2 
      Caption         =   "Group By"
      Height          =   405
      Index           =   0
      Left            =   0
      TabIndex        =   2
      Top             =   0
      Value           =   1  'Checked
      Width           =   1095
   End
   Begin VB.CheckBox Check2 
      Caption         =   "Group By"
      Height          =   405
      Index           =   1
      Left            =   1230
      TabIndex        =   1
      Top             =   0
      Value           =   1  'Checked
      Width           =   1095
   End
   Begin VB.CheckBox Check1 
      Caption         =   "Landscape"
      Height          =   255
      Left            =   3540
      TabIndex        =   0
      Top             =   990
      Width           =   1245
   End
   Begin VB.Label Label1 
      AutoSize        =   -1  'True
      Caption         =   "Label1"
      Height          =   195
      Left            =   3840
      TabIndex        =   54
      Top             =   1530
      Width           =   480
   End
End
Attribute VB_Name = "Form1"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Dim lPageNum As Long
Dim i As Long

Dim h(1 To 3) As Long
Dim f(1 To 3) As Long
Dim r(1 To 6) As Long

Dim t(1 To 7) As String

Dim TotalValue(4 To 6) As Long
Dim TotalRec As Long

Dim blnAfter As Boolean
Dim blnCancelPrinting As Boolean

Private Sub Check1_Click()
    ucReport1.CancelReport
    If Check1.Value = vbChecked Then
        ucReport1.PaperOrientation = ppoPRORLandscape
    Else
        ucReport1.PaperOrientation = ppoPRORPortrait
    End If
End Sub

Private Sub Check2_Click(Index As Integer)
    If Index > 0 Then
        If Check2(Index).Value = vbChecked Then If Check2(Index - 1).Value <> vbChecked Then Check2(Index - 1).Value = vbChecked
    Else
        If Check2(Index).Value <> vbChecked Then
            Check2(2).Value = 0
            Check2(1).Value = 0
        End If
    End If
End Sub

Private Sub Command1_Click(Index As Integer)
    Dim s As String

    If Index = 0 Then
        If Check2(0).Value = vbChecked Then
            s = "a"
            If Check2(1).Value = vbChecked Then s = s & ",b"
            If Check2(2).Value = vbChecked Then s = s & ",c"
        Else
            s = ""
        End If
        ucReport1.StartReport Printer, s
        For i = Text1.LBound To Text1.UBound
            ucReport1.ReportOutput Text1(i).Text & "," & Text2(i).Text & "," & Text3(i).Text
        Next i
        ucReport1.FinishReport
    ElseIf Index = 1 Then
        ucReport1.Preview
    ElseIf Index = 2 Then
        ucReport1.SendToPrinter
    ElseIf Index = 3 Then
        ucReport1.CancelReport
    Else
        blnCancelPrinting = True
    End If
End Sub

Private Sub ucReport1_AfterGroupOf(ByVal GroupID As String, ByVal GroupValue As String)
    Dim l As Long

    If GroupID = "a" Then
        l = 4
    ElseIf GroupID = "b" Then
        l = 5
    ElseIf GroupID = "c" Then
        l = 6
    End If
    ucReport1.SkipLine 1
    ucReport1.PrintOutput True, r(l), "GROUP " & GroupValue & " (COUNT = " & TotalValue(l) & ")"
    If l = 4 Then
        ucReport1.SkipPage
        blnAfter = False
    Else
        If Not blnAfter Then blnAfter = True
    End If
End Sub

Private Sub ucReport1_BeforeGroupOf(ByVal GroupID As String, ByVal GroupValue As String)
    Dim l As Long

    If GroupID = "a" Then
        l = 4
    ElseIf GroupID = "b" Then
        l = 5
    ElseIf GroupID = "c" Then
        l = 6
    End If
    If blnAfter Then ucReport1.SkipLine 1
    ucReport1.PrintOutput True, r(l), "GROUP OF " & GroupValue
    TotalValue(l) = 0
    blnAfter = False
End Sub

Private Sub ucReport1_FirstPageHeader()
    t(1) = Format(Now, "dd/mm/yyyy")
    t(2) = "TEST REPORT"
    t(3) = Format(Now, "hh:mm")
    
    h(1) = 3
    h(2) = (ucReport1.PageWidth - Len(t(2))) \ 2
    h(3) = ucReport1.PageWidth - 6
    
    t(7) = "PAGE NUM : "
    
    f(1) = 3
    f(2) = f(1) + Len(t(7))
    f(3) = ucReport1.PageWidth - 9
    
    t(4) = "TEXT 1"
    t(5) = "TEXT 2"
    t(6) = "TEXT 3"
    
    r(1) = 15
    r(2) = 30
    r(3) = 45

    r(4) = 7
    r(5) = r(4) + 5
    r(6) = r(5) + 5
    
    TotalRec = 0
End Sub

Private Sub ucReport1_OnEveryRow()
    Dim l As Long
    
    ucReport1.PrintOutput True, r(1), Text1(i).Text, r(2), Text2(i).Text, r(3), Text3(i).Text
    For l = 4 To 6
        TotalValue(l) = TotalValue(l) + 1
    Next l
    TotalRec = TotalRec + 1
End Sub

Private Sub ucReport1_OnLastRow()
    ucReport1.SkipLine 1
    ucReport1.PrintLine "="
    ucReport1.SkipLine 1
    ucReport1.PrintOutput True, f(1), "TOTAL RECORD PRINTED " & TotalRec
End Sub

Private Sub ucReport1_PageFooter()
    ucReport1.SkipLine 3
    ucReport1.PrintLine "-"
    ucReport1.SkipLine 1
    ucReport1.PrintOutput True, f(1), t(7), f(2), "%PAGENUM%", f(3), "%TIME%"
End Sub

Private Sub ucReport1_PageHeader()
    ucReport1.PrintOutput True, h(1), t(1), h(2), t(2), h(3), t(3)
    ucReport1.SkipLine 1
    ucReport1.PrintLine "-"
    ucReport1.SkipLine 1
    ucReport1.PrintOutput True, r(1), t(4), r(2), t(5), r(3), t(6)
    ucReport1.SkipLine 1
End Sub

Private Sub ucReport1_Printing(ByVal Percentage As Single, Cancel As Boolean)
    Label1.Caption = Percentage
    Cancel = blnCancelPrinting
End Sub

